<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AOE4 Battle Simulator</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
 <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container">
    <h1 class="text-center mb-4">‚öîÔ∏è AOE4 Battle Simulator ‚öîÔ∏è</h1>
    
    <div class="text-center">
      <div class="auto-balance-toggle">
        <input type="checkbox" id="autoBalance" checked>
        <label for="autoBalance" class="ms-2 fw-bold">Auto-balance units by cost</label>
      </div>
    </div>

    <div class="row g-4">
      <!-- ==================== UNIT A PANEL ==================== -->
      <div class="col-lg-5">
        <div class="card">
          <div class="card-body">
            <h3 class="card-title text-primary">Unit A</h3>
            
            <!-- Unit Selection and Age -->
            <div class="row g-3 mb-3">
              <div class="col-8">
                <label class="form-label fw-bold">Unit</label>
                <select id="unitASelect" class="form-select"></select>
              </div>
              <div class="col-4">
                <label class="form-label fw-bold">Age</label>
                <select id="unitAAge" class="form-select"></select>
              </div>
            </div>

            <!-- Weapon Mode Selection -->
            <div class="mb-3">
              <label class="form-label fw-bold">Weapon Mode</label>
              <div class="btn-group w-100 weapon-mode-group" role="group">
                <input type="radio" class="btn-check" name="weaponModeA" id="primaryA" value="primary" checked>
                <label class="btn btn-outline-primary btn-sm" for="primaryA">Primary</label>
                
                <input type="radio" class="btn-check" name="weaponModeA" id="secondaryA" value="secondary">
                <label class="btn btn-outline-primary btn-sm" for="secondaryA">Secondary</label>
                
                <input type="radio" class="btn-check" name="weaponModeA" id="bothA" value="both">
                <label class="btn btn-outline-primary btn-sm" for="bothA">Both</label>
              </div>
            </div>

            <!-- Unit Count -->
            <div class="mb-3">
              <label class="form-label fw-bold">Number of Units</label>
              <input id="countA" type="number" class="form-control" value="10" min="1">
            </div>

            <!-- Base Stats -->
            <div class="stat-box">
              <h6 class="fw-bold mb-3">üìä Stats</h6>
              <div class="row g-2">
                <div class="col-6">
                  <small class="text-muted">HP</small>
                  <input id="A_hp" type="number" class="form-control small-input" placeholder="HP"></div>
                <div class="col-6"><small class="text-muted">Attack</small><input id="A_attack" type="number" class="form-control small-input" placeholder="Attack"></div>
                <div class="col-6"><small class="text-muted">Melee Armor</small><input id="A_meleeArmor" type="number" class="form-control small-input" placeholder="Melee Armor"></div>
                <div class="col-6"><small class="text-muted">Ranged Armor</small><input id="A_rangedArmor" type="number" class="form-control small-input" placeholder="Ranged Armor"></div>
                <div class="col-12"><small class="text-muted">Attack Speed (s)</small><input id="A_attackSpeed" type="number" step="0.01" class="form-control small-input" placeholder="Attack Speed (s)"></div>
              </div>
            </div>

            <!-- UPDATED: Separated Flat Buffs with Individual Durations -->
            <div class="buff-box">
              <h6 class="fw-bold mb-3">‚ö° Flat Buffs</h6>
              
              <!-- Attack Flat Buff -->
              <div class="row g-2 mb-2">
                <div class="col-12"><small class="text-muted">Attack Bonus (absolute value)</small></div>
                <div class="col-6">
                  <input id="A_buffAttackAbs" type="number" class="form-control small-input" placeholder="+Attack">
                </div>
                <div class="col-6">
                  <input id="A_buffAttackAbsDur" type="number" class="form-control small-input" placeholder="Duration (0=‚àû)" value="0">
                </div>
              </div>
              
              <!-- HP Flat Buff -->
              <div class="row g-2 mb-2">
                <div class="col-12"><small class="text-muted">HP Bonus (absolute value)</small></div>
                <div class="col-6">
                  <input id="A_buffHPabs" type="number" class="form-control small-input" placeholder="+HP">
                </div>
                <div class="col-6">
                  <input id="A_buffHPabsDur" type="number" class="form-control small-input" placeholder="Duration (0=‚àû)" value="0">
                </div>
              </div>
              
              <!-- Armor Flat Buffs -->
              <div class="row g-2">
                <div class="col-12"><small class="text-muted">Armor Bonuses</small></div>
                <div class="col-6">
                  <input id="A_buffMeleeArmor" type="number" class="form-control small-input" placeholder="+Melee Armor">
                </div>
                <div class="col-6">
                  <input id="A_buffRangedArmor" type="number" class="form-control small-input" placeholder="+Ranged Armor">
                </div>
                <div class="col-12">
                  <input id="A_buffArmorDur" type="number" class="form-control small-input" placeholder="Duration (0=‚àû)" value="0">
                </div>
              </div>
            </div>

            <!-- UPDATED: Percentage Buffs with Individual Durations -->
            <div class="buff-box">
              <h6 class="fw-bold mb-3">‚ö° Percentage Buffs</h6>
              
              <!-- Attack % Buff -->
              <div class="row g-2 mb-2">
                <div class="col-12"><small class="text-muted">Attack Multiplier (%)</small></div>
                <div class="col-6">
                  <input id="A_buffAttackPct" type="number" class="form-control small-input" placeholder="Attack %">
                </div>
                <div class="col-6">
                  <input id="A_buffAttackPctDur" type="number" class="form-control small-input" placeholder="Duration (0=‚àû)" value="0">
                </div>
              </div>
              
              <!-- HP % Buff -->
              <div class="row g-2 mb-2">
                <div class="col-12"><small class="text-muted">HP Multiplier (%)</small></div>
                <div class="col-6">
                  <input id="A_buffHPpct" type="number" class="form-control small-input" placeholder="HP %">
                </div>
                <div class="col-6">
                  <input id="A_buffHPpctDur" type="number" class="form-control small-input" placeholder="Duration (0=‚àû)" value="0">
                </div>
              </div>
              
              <!-- Attack Speed % Buff -->
              <div class="row g-2">
                <div class="col-12"><small class="text-muted">Attack Speed Multiplier (%)</small></div>
                <div class="col-6">
                  <input id="A_buffSpeedPct" type="number" class="form-control small-input" placeholder="Speed %">
                </div>
                <div class="col-6">
                  <input id="A_buffSpeedPctDur" type="number" class="form-control small-input" placeholder="Duration (0=‚àû)" value="0">
                </div>
              </div>
            </div>

            <!-- First Hit Advantage -->
            <div class="first-hit-box">
              <h6 class="fw-bold mb-2">üéØ First-Hit Advantage</h6>
              <div class="form-check mb-2">
                <input class="form-check-input" type="checkbox" id="A_firstHitEnabled">
                <label class="form-check-label" for="A_firstHitEnabled">Enable free hits</label>
              </div>
              <input id="A_freeHits" type="number" class="form-control small-input" value="0" min="0" placeholder="Free hits">
            </div>

            <!-- Info Display -->
            <div class="small text-muted">
              <strong>Tags:</strong> <span id="A_tags"></span><br>
              <strong>Bonuses:</strong> <span id="A_bonuses"></span>
            </div>
          </div>
        </div>
      </div>

      <!-- ==================== BATTLE BUTTON ==================== -->
      <div class="col-lg-2 d-flex align-items-center justify-content-center">
        <button id="battleBtn" class="battle-btn">‚öîÔ∏è</button>
      </div>

      <!-- ==================== UNIT B PANEL (Mirror of Unit A) ==================== -->
      <div class="col-lg-5">
        <div class="card">
          <div class="card-body">
            <h3 class="card-title text-danger">Unit B</h3>
            
            <div class="row g-3 mb-3">
              <div class="col-8">
                <label class="form-label fw-bold">Unit</label>
                <select id="unitBSelect" class="form-select"></select>
              </div>
              <div class="col-4">
                <label class="form-label fw-bold">Age</label>
                <select id="unitBAge" class="form-select"></select>
              </div>
            </div>

            <!-- NEW: Weapon Mode Selection for Unit B -->
            <div class="mb-3">
              <label class="form-label fw-bold">Weapon Mode</label>
              <div class="btn-group w-100 weapon-mode-group" role="group">
                <input type="radio" class="btn-check" name="weaponModeB" id="primaryB" value="primary" checked>
                <label class="btn btn-outline-primary btn-sm" for="primaryB">Primary</label>
                
                <input type="radio" class="btn-check" name="weaponModeB" id="secondaryB" value="secondary">
                <label class="btn btn-outline-primary btn-sm" for="secondaryB">Secondary</label>
                
                <input type="radio" class="btn-check" name="weaponModeB" id="bothB" value="both">
                <label class="btn btn-outline-primary btn-sm" for="bothB">Both</label>
              </div>
            </div>

            <div class="mb-3">
              <label class="form-label fw-bold">Number of Units</label>
              <input id="countB" type="number" class="form-control" value="10" min="1">
            </div>

            <div class="stat-box">
              <h6 class="fw-bold mb-3">üìä Stats</h6>
              <div class="row g-2">
                <div class="col-6"><small class="text-muted">HP</small><input id="B_hp" type="number" class="form-control small-input" placeholder="HP"></div>
                <div class="col-6"><small class="text-muted">Attack</small><input id="B_attack" type="number" class="form-control small-input" placeholder="Attack"></div>
                <div class="col-6"><small class="text-muted">Melee Armor</small><input id="B_meleeArmor" type="number" class="form-control small-input" placeholder="Melee Armor"></div>
                <div class="col-6"><small class="text-muted">Ranged Armor</small><input id="B_rangedArmor" type="number" class="form-control small-input" placeholder="Ranged Armor"></div>
                <div class="col-12"><small class="text-muted">Attack Speed (s)</small><input id="B_attackSpeed" type="number" step="0.01" class="form-control small-input" placeholder="Attack Speed (s)"></div>
              </div>
            </div>

            <!-- Flat Buffs for Unit B -->
            <div class="buff-box">
              <h6 class="fw-bold mb-3">‚ö° Flat Buffs</h6>
              <div class="row g-2 mb-2">
                <div class="col-12"><small class="text-muted">Attack Bonus (absolute value)</small></div>
                <div class="col-6">
                  <input id="B_buffAttackAbs" type="number" class="form-control small-input" placeholder="+Attack">
                </div>
                <div class="col-6">
                  <input id="B_buffAttackAbsDur" type="number" class="form-control small-input" placeholder="Duration (0=‚àû)" value="0">
                </div>
              </div>
              <div class="row g-2 mb-2">
                <div class="col-12"><small class="text-muted">HP Bonus (absolute value)</small></div>
                <div class="col-6">
                  <input id="B_buffHPabs" type="number" class="form-control small-input" placeholder="+HP">
                </div>
                <div class="col-6">
                  <input id="B_buffHPabsDur" type="number" class="form-control small-input" placeholder="Duration (0=‚àû)" value="0">
                </div>
              </div>
              <div class="row g-2">
                <div class="col-12"><small class="text-muted">Armor Bonuses</small></div>
                <div class="col-6">
                  <input id="B_buffMeleeArmor" type="number" class="form-control small-input" placeholder="+Melee Armor">
                </div>
                <div class="col-6">
                  <input id="B_buffRangedArmor" type="number" class="form-control small-input" placeholder="+Ranged Armor">
                </div>
                <div class="col-12">
                  <input id="B_buffArmorDur" type="number" class="form-control small-input" placeholder="Duration (0=‚àû)" value="0">
                </div>
              </div>
            </div>

            <!-- Percentage Buffs for Unit B -->
            <div class="buff-box">
              <h6 class="fw-bold mb-3">‚ö° Percentage Buffs</h6>
              <div class="row g-2 mb-2">
                <div class="col-12"><small class="text-muted">Attack Multiplier (%)</small></div>
                <div class="col-6">
                  <input id="B_buffAttackPct" type="number" class="form-control small-input" placeholder="Attack %">
                </div>
                <div class="col-6">
                  <input id="B_buffAttackPctDur" type="number" class="form-control small-input" placeholder="Duration (0=‚àû)" value="0">
                </div>
              </div>
              <div class="row g-2 mb-2">
                <div class="col-12"><small class="text-muted">HP Multiplier (%)</small></div>
                <div class="col-6">
                  <input id="B_buffHPpct" type="number" class="form-control small-input" placeholder="HP %">
                </div>
                <div class="col-6">
                  <input id="B_buffHPpctDur" type="number" class="form-control small-input" placeholder="Duration (0=‚àû)" value="0">
                </div>
              </div>
              <div class="row g-2">
                <div class="col-12"><small class="text-muted">Attack Speed Multiplier (%)</small></div>
                <div class="col-6">
                  <input id="B_buffSpeedPct" type="number" class="form-control small-input" placeholder="Speed %">
                </div>
                <div class="col-6">
                  <input id="B_buffSpeedPctDur" type="number" class="form-control small-input" placeholder="Duration (0=‚àû)" value="0">
                </div>
              </div>
            </div>

            <div class="first-hit-box">
              <h6 class="fw-bold mb-2">üéØ First-Hit Advantage</h6>
              <div class="form-check mb-2">
                <input class="form-check-input" type="checkbox" id="B_firstHitEnabled">
                <label class="form-check-label" for="B_firstHitEnabled">Enable free hits</label>
              </div>
              <input id="B_freeHits" type="number" class="form-control small-input" value="0" min="0" placeholder="Free hits">
            </div>

            <div class="small text-muted">
              <strong>Tags:</strong> <span id="B_tags"></span><br>
              <strong>Bonuses:</strong> <span id="B_bonuses"></span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ==================== RESULTS DISPLAY ==================== -->
    <div id="results" style="display: none;" class="results-card">
      <!-- UPDATED: Now shows unit names in the winner text -->
      <h2 class="text-center mb-4" id="winnerText"></h2>
      <div class="row">
        <div class="col-md-3">
          <div class="result-stat">
            <div class="result-stat-value" id="remainingUnits"></div>
            <div class="result-stat-label">Units Remaining</div>
          </div>
        </div>
        <div class="col-md-3">
          <div class="result-stat">
            <div class="result-stat-value" id="remainingHP"></div>
            <div class="result-stat-label">HP Remaining</div>
          </div>
        </div>
        <div class="col-md-3">
          <div class="result-stat">
            <div class="result-stat-value" id="resourcesLost"></div>
            <div class="result-stat-label">Resources Lost</div>
          </div>
        </div>
        <div class="col-md-3">
          <div class="result-stat">
            <div class="result-stat-value" id="battleDuration"></div>
            <div class="result-stat-label">Battle Duration</div>
          </div>
        </div>
      </div>
      <div class="text-center mt-3">
        <span id="finalCounts"></span>
      </div>
    </div>
  </div>

  <script src="script.js"></script>
</body>
</html>