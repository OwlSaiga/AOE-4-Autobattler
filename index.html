<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AOE4 Battle Simulator – Final Version</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script defer src="script.js"></script>
  <style>
    body {
      background: #f8f9fa;
    }

    .card {
      background: #fff;
    }

    .small-label {
      font-size: 0.85rem;
    }

    hr {
      margin: 1rem 0;
    }
  </style>
</head>

<body class="p-3">

  <div class="container">

    <h1 class="text-center my-4">AOE4 Battle Simulator</h1>

    <div class="row g-4">

      <!-- ==================== UNIT A ==================== -->
      <div class="col-lg-5">
        <div class="card shadow-sm">
          <div class="card-body">

            <h4 class="card-title">Unit A</h4>

            <!-- Unit & Age -->
            <div class="row g-3 mb-3">
              <div class="col-8">
                <label class="form-label">Unit</label>
                <select id="unitASelect" class="form-select"></select>
              </div>
              <div class="col-4">
                <label class="form-label">Age</label>
                <select id="unitAAge" class="form-select">
                  <option value="2">II</option>
                  <option value="3" selected>III</option>
                  <option value="4">IV</option>
                </select>
              </div>
            </div>

            <!-- Weapon Mode -->
            <div class="mb-3">
              <label class="form-label">Weapon Mode</label>
              <div class="btn-group w-100" role="group">
                <input type="radio" class="btn-check" name="weaponModeA" id="primaryA" value="primary" checked>
                <label class="btn btn-outline-primary" for="primaryA">Primary Only</label>

                <input type="radio" class="btn-check" name="weaponModeA" id="secondaryA" value="secondary">
                <label class="btn btn-outline-primary" for="secondaryA">Secondary Only</label>

                <input type="radio" class="btn-check" name="weaponModeA" id="bothA" value="both">
                <label class="btn btn-outline-primary" for="bothA">Both</label>
              </div>
            </div>

            <!-- Unit Count -->
            <div class="mb-3">
              <label class="form-label">Number of Units</label>
              <input id="countA" type="number" class="form-control" value="10" min="1">
            </div>

            <!-- Editable Core Stats -->
            <hr>
            <h6 class="small-label">Editable Stats (override JSON)</h6>
            <div class="row g-2">
              <div class="col-6"><input id="A_hp" type="number" class="form-control form-control-sm" placeholder="HP">
              </div>
              <div class="col-6"><input id="A_meleeArmor" type="number" class="form-control form-control-sm"
                  placeholder="Melee Armor"></div>
              <div class="col-6"><input id="A_rangedArmor" type="number" class="form-control form-control-sm"
                  placeholder="Ranged Armor"></div>
              <div class="col-6"><input id="A_attack" type="number" class="form-control form-control-sm"
                  placeholder="Attack"></div>
              <div class="col-6"><input id="A_attackSpeed" type="number" step="0.01"
                  class="form-control form-control-sm" placeholder="Attack Speed (s)"></div>
              <div class="col-12"><input id="A_bonus" type="text" class="form-control form-control-sm"
                  placeholder='Bonus JSON → {"Cavalry":13}'></div>
            </div>

            <!-- Buffs -->
            <hr>
            <h6 class="small-label">Buffs (duration in seconds, 0 = permanent)</h6>
            <div class="row g-2 mb-2">
              <div class="col-4"><input id="A_buffAttackAbs" type="number" class="form-control form-control-sm"
                  placeholder="Attack +abs"></div>
              <div class="col-4"><input id="A_buffAttackPct" type="number" class="form-control form-control-sm"
                  placeholder="Attack +%"></div>
              <div class="col-4"><input id="A_buffAttackDur" type="number" class="form-control form-control-sm"
                  value="0"></div>
            </div>
            <div class="row g-2 mb-2">
              <div class="col-6"><input id="A_buffHPabs" type="number" class="form-control form-control-sm"
                  placeholder="HP +abs"></div>
              <div class="col-6"><input id="A_buffHPpct" type="number" class="form-control form-control-sm"
                  placeholder="HP +%"></div>
              <div class="col-12"><input id="A_buffHPDur" type="number" class="form-control form-control-sm" value="0">
              </div>
            </div>
            <div class="row g-2 mb-2">
              <div class="col-6"><input id="A_buffSpeedPct" type="number" class="form-control form-control-sm"
                  placeholder="Atk Speed +%"></div>
              <div class="col-6"><input id="A_buffSpeedDur" type="number" class="form-control form-control-sm"
                  value="0"></div>
            </div>
            <div class="row g-2 mb-2">
              <div class="col-6"><input id="A_buffMeleeArmor" type="number" class="form-control form-control-sm"
                  placeholder="Melee Armor +"></div>
              <div class="col-6"><input id="A_buffRangedArmor" type="number" class="form-control form-control-sm"
                  placeholder="Ranged Armor +"></div>
              <div class="col-12"><input id="A_buffArmorDur" type="number" class="form-control form-control-sm"
                  value="0"></div>
            </div>

            <!-- Free Hits / First-Hit Advantage -->
            <hr>
            <h6 class="small-label">First-Hit Advantage</h6>
            <div class="form-check mb-2">
              <input class="form-check-input" type="checkbox" id="A_firstHitEnabled">
              <label class="form-check-label" for="A_firstHitEnabled">Enable free hits</label>
            </div>
            <div class="mb-3">
              <label class="form-label">Free hits (both weapons)</label>
              <input id="A_freeHits" type="number" class="form-control" value="0" min="0">
            </div>
            <!-- SPECIAL EFFECTS (optional override) -->
            <hr>
            <div class="accordion" id="effectsAccordionA">
              <div class="accordion-item">
                <h2 class="accordion-header">
                  <button class="accordion-button collapsed fw-bold" type="button" data-bs-toggle="collapse"
                    data-bs-target="#effectsPanelA">
                    Special Effects (click to edit)
                  </button>
                </h2>
                <div id="effectsPanelA" class="accordion-collapse collapse">
                  <div class="accordion-body">
                    <textarea id="A_effects" class="form-control form-control-sm" rows="6" placeholder='Example:
[
  { "type": "healPerAttack", "value": 3, "weapon": "primary" },
  { "type": "aura", "stat": "meleeArmor", "value": 2, "radius": 5 }
]'></textarea>
                    <small class="text-muted d-block mt-2">
                      Leave empty = use JSON. Paste array to override/add effects.
                    </small>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- ==================== BATTLE BUTTON ==================== -->
      <div class="col-lg-2 d-flex align-items-center justify-content-center">
        <button id="battleBtn" class="btn btn-danger btn-lg px-5 py-4">BATTLE</button>
      </div>

      <!-- ==================== UNIT B (mirror of A) ==================== -->
      <div class="col-lg-5">
        <div class="card shadow-sm">
          <div class="card-body">

            <h4 class="card-title">Unit B</h4>

            <div class="row g-3 mb-3">
              <div class="col-8">
                <label class="form-label">Unit</label>
                <select id="unitBSelect" class="form-select"></select>
              </div>
              <div class="col-4">
                <label class="form-label">Age</label>
                <select id="unitBAge" class="form-select">
                  <option value="2">II</option>
                  <option value="3" selected>III</option>
                  <option value="4">IV</option>
                </select>
              </div>
            </div>

            <div class="mb-3">
              <label class="form-label">Weapon Mode</label>
              <div class="btn-group w-100" role="group">
                <input type="radio" class="btn-check" name="weaponModeB" id="primaryB" value="primary" checked>
                <label class="btn btn-outline-primary" for="primaryB">Primary Only</label>
                <input type="radio" class="btn-check" name="weaponModeB" id="secondaryB" value="secondary">
                <label class="btn btn-outline-primary" for="secondaryB">Secondary Only</label>
                <input type="radio" class="btn-check" name="weaponModeB" id="bothB" value="both">
                <label class="btn btn-outline-primary" for="bothB">Both</label>
              </div>
            </div>

            <div class="mb-3">
              <label class="form-label">Number of Units</label>
              <input id="countB" type="number" class="form-control" value="10" min="1">
            </div>

            <hr>
            <h6 class="small-label">Editable Stats (override JSON)</h6>
            <div class="row g-2">
              <div class="col-6"><input id="B_hp" type="number" class="form-control form-control-sm" placeholder="HP">
              </div>
              <div class="col-6"><input id="B_meleeArmor" type="number" class="form-control form-control-sm"
                  placeholder="Melee Armor"></div>
              <div class="col-6"><input id="B_rangedArmor" type="number" class="form-control form-control-sm"
                  placeholder="Ranged Armor"></div>
              <div class="col-6"><input id="B_attack" type="number" class="form-control form-control-sm"
                  placeholder="Attack"></div>
              <div class="col-6"><input id="B_attackSpeed" type="number" step="0.01"
                  class="form-control form-control-sm" placeholder="Attack Speed (s)"></div>
              <div class="col-12"><input id="B_bonus" type="text" class="form-control form-control-sm"
                  placeholder='Bonus JSON → {"Cavalry":13}'></div>
            </div>

            <!-- Buffs for Unit B — NOW FULLY IDENTICAL TO UNIT A -->
            <hr>
            <h6 class="small-label">Buffs (duration in seconds, 0 = permanent)</h6>
            <div class="row g-2 mb-2">
              <div class="col-4"><input id="B_buffAttackAbs" type="number" class="form-control form-control-sm"
                  placeholder="Attack +abs"></div>
              <div class="col-4"><input id="B_buffAttackPct" type="number" class="form-control form-control-sm"
                  placeholder="Attack +%"></div>
              <div class="col-4"><input id="B_buffAttackDur" type="number" class="form-control form-control-sm"
                  value="0"></div>
            </div>
            <div class="row g-2 mb-2">
              <div class="col-6"><input id="B_buffHPabs" type="number" class="form-control form-control-sm"
                  placeholder="HP +abs"></div>
              <div class="col-6"><input id="B_buffHPpct" type="number" class="form-control form-control-sm"
                  placeholder="HP +%"></div>
              <div class="col-12"><input id="B_buffHPDur" type="number" class="form-control form-control-sm" value="0">
              </div>
            </div>
            <div class="row g-2 mb-2">
              <div class="col-6"><input id="B_buffSpeedPct" type="number" class="form-control form-control-sm"
                  placeholder="Atk Speed +%"></div>
              <div class="col-6"><input id="B_buffSpeedDur" type="number" class="form-control form-control-sm"
                  value="0"></div>
            </div>
            <div class="row g-2 mb-2">
              <div class="col-6"><input id="B_buffMeleeArmor" type="number" class="form-control form-control-sm"
                  placeholder="Melee Armor +"></div>
              <div class="col-6"><input id="B_buffRangedArmor" type="number" class="form-control form-control-sm"
                  placeholder="Ranged Armor +"></div>
              <div class="col-12"><input id="B_buffArmorDur" type="number" class="form-control form-control-sm"
                  value="0"></div>
            </div>
            <!-- (same pattern for HP, Speed, Armor — exactly like A, just B_ prefix) -->
            <!-- I omitted repeating them to save space — copy the block from A and change prefix to B_ -->

            <hr>
            <h6 class="small-label">First-Hit Advantage</h6>
            <div class="form-check mb-2">
              <input class="form-check-input" type="checkbox" id="B_firstHitEnabled">
              <label class="form-check-label" for="B_firstHitEnabled">Enable free hits</label>
            </div>
            <div>
              <label class="form-label">Free hits (both weapons)</label>
              <input id="B_freeHits" type="number" class="form-control" value="0" min="0">
            </div>
            <!-- SPECIAL EFFECTS (optional override) -->
            <hr>
            <div class="accordion" id="effectsAccordionB">
              <div class="accordion-item">
                <h2 class="accordion-header">
                  <button class="accordion-button collapsed fw-bold" type="button" data-bs-toggle="collapse"
                    data-bs-target="#effectsPanelB">
                    Special Effects (click to edit)
                  </button>
                </h2>
                <div id="effectsPanelB" class="accordion-collapse collapse">
                  <div class="accordion-body">
                    <textarea id="B_effects" class="form-control form-control-sm" rows="6" placeholder='Example:
[
  { "type": "healPerAttack", "value": 3, "weapon": "primary" },
  { "type": "aura", "stat": "meleeArmor", "value": 2, "radius": 5 }
]'></textarea>
                    <small class="text-muted d-block mt-2">
                      Leave empty = use JSON. Paste array to override/add effects.
                    </small>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ==================== RESULTS ==================== -->
    <div class="mt-4 card shadow-sm">
      <div class="card-body text-center">
        <h4>Battle Results</h4>
        <div id="results" class="mt-3 fs-5 text-muted">
          Select units and press BATTLE to simulate...
        </div>
      </div>
    </div>

  </div>
</body>

</html>